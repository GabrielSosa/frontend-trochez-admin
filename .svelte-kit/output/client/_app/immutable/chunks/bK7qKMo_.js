var p=Object.defineProperty;var d=(o,e,n)=>e in o?p(o,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):o[e]=n;var s=(o,e,n)=>d(o,typeof e!="symbol"?e+"":e,n);const a="https://api-backend-trochez.onrender.com";class r{static getCustomUrl(e){return`${a}${e}`}}s(r,"AUTH",{login:`${a}/api/security/signin`,register:`${a}/api/security/signup`}),s(r,"USERS",{getAll:`${a}/api/users`,getById:e=>`${a}/api/users/${e}`,create:`${a}/api/users`,update:e=>`${a}/api/users/${e}`,delete:e=>`${a}/api/users/${e}`}),s(r,"AVALUOS",{getAll:`${a}/api/appraisals`,getById:e=>`${a}/api/appraisals/${e}`,create:`${a}/api/appraisals`,update:e=>`${a}/api/appraisals/${e}`,delete:e=>`${a}/api/appraisals/${e}`}),s(r,"CERTIFICADOS",{get:e=>`${a}/certificates/appraisal/${e}`});const g=async(o,e={})=>{const n={headers:{"Content-Type":"application/json"}};try{const t=localStorage.getItem("jwtToken");console.log("Token en localStorage:",t),t&&t!=="undefined"&&t!=="null"?(t.startsWith("Bearer ")?n.headers.Authorization=t:n.headers.Authorization=`Bearer ${t}`,console.log("Token aplicado:",n.headers.Authorization)):(console.warn("No se encontr칩 token JWT v치lido en localStorage"),!o.includes("/signin")&&!o.includes("/signup")&&(console.warn("Intentando acceder a ruta protegida sin token. Redirigiendo..."),setTimeout(()=>{typeof window<"u"&&(window.location.href="/login")},100)))}catch(t){console.error("Error al obtener el token JWT:",t)}const l={...n,...e,headers:{...n.headers,...e.headers}},i=await fetch(o,l);if(!i.ok){const t=await i.json().catch(()=>({})),c=new Error(t.message||"Error en la petici칩n");throw c.status=i.status,c.data=t,i.status===401&&(console.error("Error de autenticaci칩n 401. Limpiando token..."),localStorage.removeItem("jwtToken"),setTimeout(()=>{typeof window<"u"&&!window.location.pathname.includes("/login")&&(window.location.href="/login")},100)),c}return await i.json()};export{r as A,g as a};
