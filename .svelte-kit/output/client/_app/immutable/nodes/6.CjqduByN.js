import{S as Y,i as Z,s as $,n as F,d as g,B as ee,L as O,a as K,b as Q,c as a,C as B,V as te,w as s,e as p,f as E,y as q,h as x,g as W,j as m,k as C,t as X,A as se}from"../chunks/CnbjcvQe.js";import"../chunks/IHki7fMi.js";import{g as R}from"../chunks/D73rw0UH.js";import{A as re}from"../chunks/BDh5lRBQ.js";const ae=!1,oe=!1,fe=Object.freeze(Object.defineProperty({__proto__:null,prerender:ae,ssr:oe},Symbol.toStringTag,{value:"Module"}));function G(d){let r,e,o;return{c(){r=m("div"),e=m("span"),o=X(d[2]),this.h()},l(l){r=p(l,"DIV",{class:!0,role:!0});var c=E(r);e=p(c,"SPAN",{class:!0});var t=E(e);o=W(t,d[2]),t.forEach(g),c.forEach(g),this.h()},h(){s(e,"class","block sm:inline"),s(r,"class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"),s(r,"role","alert")},m(l,c){Q(l,r,c),a(r,e),a(e,o)},p(l,c){c&4&&K(o,l[2])},d(l){l&&g(r)}}}function ne(d){let r,e,o,l='<h1 class="text-2xl font-bold text-gray-800">Avalúos Trochez</h1> <p class="text-gray-600">Panel de Administración</p>',c,t,S,_,b,w="Correo Electrónico",f,i,P,T,k,H="Contraseña",V,h,M,y,j=d[3]?"Iniciando sesión...":"Iniciar Sesión",A,U,z,n=d[2]&&G(d);return{c(){r=m("div"),e=m("div"),o=m("div"),o.innerHTML=l,c=C(),t=m("form"),n&&n.c(),S=C(),_=m("div"),b=m("label"),b.textContent=w,f=C(),i=m("input"),P=C(),T=m("div"),k=m("label"),k.textContent=H,V=C(),h=m("input"),M=C(),y=m("button"),A=X(j),this.h()},l(u){r=p(u,"DIV",{class:!0});var v=E(r);e=p(v,"DIV",{class:!0});var D=E(e);o=p(D,"DIV",{class:!0,"data-svelte-h":!0}),q(o)!=="svelte-1urdbpm"&&(o.innerHTML=l),c=x(D),t=p(D,"FORM",{class:!0});var I=E(t);n&&n.l(I),S=x(I),_=p(I,"DIV",{});var L=E(_);b=p(L,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),q(b)!=="svelte-9oeeyk"&&(b.textContent=w),f=x(L),i=p(L,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),L.forEach(g),P=x(I),T=p(I,"DIV",{});var N=E(T);k=p(N,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),q(k)!=="svelte-1isxpbj"&&(k.textContent=H),V=x(N),h=p(N,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),N.forEach(g),M=x(I),y=p(I,"BUTTON",{type:!0,class:!0});var J=E(y);A=W(J,j),J.forEach(g),I.forEach(g),D.forEach(g),v.forEach(g),this.h()},h(){s(o,"class","text-center mb-8"),s(b,"for","email"),s(b,"class","block text-sm font-medium text-gray-700 mb-1"),s(i,"id","email"),s(i,"type","email"),i.required=!0,s(i,"class","w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),s(i,"placeholder","correo@ejemplo.com"),s(k,"for","password"),s(k,"class","block text-sm font-medium text-gray-700 mb-1"),s(h,"id","password"),s(h,"type","password"),h.required=!0,s(h,"class","w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),s(h,"placeholder","••••••••"),s(y,"type","submit"),y.disabled=d[3],s(y,"class","w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),s(t,"class","space-y-6"),s(e,"class","bg-white p-8 rounded-lg shadow-md w-full max-w-md"),s(r,"class","min-h-screen flex items-center justify-center bg-gray-100")},m(u,v){Q(u,r,v),a(r,e),a(e,o),a(e,c),a(e,t),n&&n.m(t,null),a(t,S),a(t,_),a(_,b),a(_,f),a(_,i),O(i,d[0]),a(t,P),a(t,T),a(T,k),a(T,V),a(T,h),O(h,d[1]),a(t,M),a(t,y),a(y,A),U||(z=[B(i,"input",d[5]),B(h,"input",d[6]),B(t,"submit",te(d[4]))],U=!0)},p(u,[v]){u[2]?n?n.p(u,v):(n=G(u),n.c(),n.m(t,S)):n&&(n.d(1),n=null),v&1&&i.value!==u[0]&&O(i,u[0]),v&2&&h.value!==u[1]&&O(h,u[1]),v&8&&j!==(j=u[3]?"Iniciando sesión...":"Iniciar Sesión")&&K(A,j),v&8&&(y.disabled=u[3])},i:F,o:F,d(u){u&&g(r),n&&n.d(),U=!1,ee(z)}}}function le(d,r,e){let o="",l="",c="",t=!1;se(()=>{localStorage.getItem("jwtToken")&&R("/")});async function S(){e(2,c=""),e(3,t=!0);try{const w=await fetch(re.AUTH.login,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o,password:l})}),f=await w.json();if(!w.ok)throw new Error(f.message||"Error al iniciar sesión");const i=f.token||f.accessToken||f.access_token||f.jwt||f.id_token;if(!i)throw new Error("No se pudo obtener el token de autenticación");localStorage.setItem("jwtToken",i),(f.user||f.userData)&&localStorage.setItem("userData",JSON.stringify(f.user||f.userData)),R("/")}catch(w){e(2,c=w.message||"Error al iniciar sesión. Intente nuevamente.")}finally{e(3,t=!1)}}function _(){o=this.value,e(0,o)}function b(){l=this.value,e(1,l)}return[o,l,c,t,S,_,b]}class pe extends Y{constructor(r){super(),Z(this,r,le,ne,$,{})}}export{pe as component,fe as universal};
