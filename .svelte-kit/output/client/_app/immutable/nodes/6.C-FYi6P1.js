import{S as Y,i as Z,s as $,n as R,d as v,B as ee,L as O,a as K,b as Q,c as o,C as B,R as te,w as s,e as p,f as E,y as q,h as x,g as W,j as m,k as C,t as X,A as se}from"../chunks/DH0NG5GU.js";import"../chunks/IHki7fMi.js";import{g as F}from"../chunks/DNYyVYut.js";import{A as re}from"../chunks/bK7qKMo_.js";const oe=!1,ne=!1,fe=Object.freeze(Object.defineProperty({__proto__:null,prerender:oe,ssr:ne},Symbol.toStringTag,{value:"Module"}));function G(d){let r,e,n;return{c(){r=m("div"),e=m("span"),n=X(d[2]),this.h()},l(u){r=p(u,"DIV",{class:!0,role:!0});var f=E(r);e=p(f,"SPAN",{class:!0});var t=E(e);n=W(t,d[2]),t.forEach(v),f.forEach(v),this.h()},h(){s(e,"class","block sm:inline"),s(r,"class","bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative"),s(r,"role","alert")},m(u,f){Q(u,r,f),o(r,e),o(e,n)},p(u,f){f&4&&K(n,u[2])},d(u){u&&v(r)}}}function ae(d){let r,e,n,u='<h1 class="text-2xl font-bold text-gray-800">Avalúos Trochez</h1> <p class="text-gray-600">Panel de Administración</p>',f,t,S,_,b,y="Correo Electrónico",a,l,P,T,k,H="Contraseña",V,h,M,w,j=d[3]?"Iniciando sesión...":"Iniciar Sesión",L,U,z,i=d[2]&&G(d);return{c(){r=m("div"),e=m("div"),n=m("div"),n.innerHTML=u,f=C(),t=m("form"),i&&i.c(),S=C(),_=m("div"),b=m("label"),b.textContent=y,a=C(),l=m("input"),P=C(),T=m("div"),k=m("label"),k.textContent=H,V=C(),h=m("input"),M=C(),w=m("button"),L=X(j),this.h()},l(c){r=p(c,"DIV",{class:!0});var g=E(r);e=p(g,"DIV",{class:!0});var A=E(e);n=p(A,"DIV",{class:!0,"data-svelte-h":!0}),q(n)!=="svelte-1urdbpm"&&(n.innerHTML=u),f=x(A),t=p(A,"FORM",{class:!0});var I=E(t);i&&i.l(I),S=x(I),_=p(I,"DIV",{});var D=E(_);b=p(D,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),q(b)!=="svelte-9oeeyk"&&(b.textContent=y),a=x(D),l=p(D,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),D.forEach(v),P=x(I),T=p(I,"DIV",{});var N=E(T);k=p(N,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),q(k)!=="svelte-1isxpbj"&&(k.textContent=H),V=x(N),h=p(N,"INPUT",{id:!0,type:!0,class:!0,placeholder:!0}),N.forEach(v),M=x(I),w=p(I,"BUTTON",{type:!0,class:!0});var J=E(w);L=W(J,j),J.forEach(v),I.forEach(v),A.forEach(v),g.forEach(v),this.h()},h(){s(n,"class","text-center mb-8"),s(b,"for","email"),s(b,"class","block text-sm font-medium text-gray-700 mb-1"),s(l,"id","email"),s(l,"type","email"),l.required=!0,s(l,"class","w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),s(l,"placeholder","correo@ejemplo.com"),s(k,"for","password"),s(k,"class","block text-sm font-medium text-gray-700 mb-1"),s(h,"id","password"),s(h,"type","password"),h.required=!0,s(h,"class","w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"),s(h,"placeholder","••••••••"),s(w,"type","submit"),w.disabled=d[3],s(w,"class","w-full bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"),s(t,"class","space-y-6"),s(e,"class","bg-white p-8 rounded-lg shadow-md w-full max-w-md"),s(r,"class","min-h-screen flex items-center justify-center bg-gray-100")},m(c,g){Q(c,r,g),o(r,e),o(e,n),o(e,f),o(e,t),i&&i.m(t,null),o(t,S),o(t,_),o(_,b),o(_,a),o(_,l),O(l,d[0]),o(t,P),o(t,T),o(T,k),o(T,V),o(T,h),O(h,d[1]),o(t,M),o(t,w),o(w,L),U||(z=[B(l,"input",d[5]),B(h,"input",d[6]),B(t,"submit",te(d[4]))],U=!0)},p(c,[g]){c[2]?i?i.p(c,g):(i=G(c),i.c(),i.m(t,S)):i&&(i.d(1),i=null),g&1&&l.value!==c[0]&&O(l,c[0]),g&2&&h.value!==c[1]&&O(h,c[1]),g&8&&j!==(j=c[3]?"Iniciando sesión...":"Iniciar Sesión")&&K(L,j),g&8&&(w.disabled=c[3])},i:R,o:R,d(c){c&&v(r),i&&i.d(),U=!1,ee(z)}}}function le(d,r,e){let n="",u="",f="",t=!1;se(()=>{localStorage.getItem("jwtToken")&&F("/")});async function S(){e(2,f=""),e(3,t=!0);try{const y=await fetch(re.AUTH.login,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:n,password:u})}),a=await y.json();if(!y.ok)throw new Error(a.message||"Error al iniciar sesión");console.log("Login response:",a);const l=a.token||a.accessToken||a.access_token||a.jwt||a.id_token;if(console.log("Token recibido:",l),!l)throw console.error("No se encontró token en la respuesta:",a),new Error("No se pudo obtener el token de autenticación");localStorage.setItem("jwtToken",l),(a.user||a.userData)&&localStorage.setItem("userData",JSON.stringify(a.user||a.userData)),F("/")}catch(y){console.error("Login error:",y),e(2,f=y.message||"Error al iniciar sesión. Intente nuevamente.")}finally{e(3,t=!1)}}function _(){n=this.value,e(0,n)}function b(){u=this.value,e(1,u)}return[n,u,f,t,S,_,b]}class pe extends Y{constructor(r){super(),Z(this,r,le,ae,$,{})}}export{pe as component,fe as universal};
